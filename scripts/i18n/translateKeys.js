#!/usr/bin/env node

/**
 * Script para traducir automaticamente claves de i18n del espaÃ±ol al ingles y frances
 * Usa un diccionario de traducciones comunes
 */

const fs = require('fs');
const path = require('path');

const LOCALES_DIR = path.join(__dirname, '../../src/i18n/locales');

// Diccionario de traducciones ES -> EN
const TRANSLATIONS_EN = {
  // Acciones comunes
  'aÃ±adir': 'add',
  'aÃ±ade': 'add',
  'anade': 'add',
  'anadido': 'added',
  'crear': 'create',
  'eliminar': 'delete',
  'borrar': 'delete',
  'editar': 'edit',
  'guardar': 'save',
  'cancelar': 'cancel',
  'buscar': 'search',
  'filtrar': 'filter',
  'cerrar': 'close',
  'abrir': 'open',
  'ver': 'view',
  'mostrar': 'show',
  'ocultar': 'hide',
  'subir': 'upload',
  'descargar': 'download',
  'enviar': 'send',
  'recibir': 'receive',
  'aceptar': 'accept',
  'rechazar': 'reject',
  'confirmar': 'confirm',
  'actualizar': 'update',
  'modificar': 'modify',
  'cambiar': 'change',
  'copiar': 'copy',
  'duplicar': 'duplicate',
  'mover': 'move',
  'exportar': 'export',
  'importar': 'import',
  'sincronizar': 'synchronize',
  'conectar': 'connect',
  'desconectar': 'disconnect',
  'vincular': 'link',
  'aplicar': 'apply',
  'restablecer': 'restore',
  'recargar': 'reload',
  
  // Palabras comunes
  'invitado': 'guest',
  'invitados': 'guests',
  'mesa': 'table',
  'mesas': 'tables',
  'asiento': 'seat',
  'asientos': 'seats',
  'proveedor': 'provider',
  'proveedores': 'providers',
  'transaccion': 'transaction',
  'transacciones': 'transactions',
  'categoria': 'category',
  'categorias': 'categories',
  'presupuesto': 'budget',
  'gasto': 'expense',
  'gastos': 'expenses',
  'ingreso': 'income',
  'ingresos': 'incomes',
  'precio': 'price',
  'costo': 'cost',
  'total': 'total',
  'subtotal': 'subtotal',
  'balance': 'balance',
  'monto': 'amount',
  'cantidad': 'quantity',
  'fecha': 'date',
  'hora': 'time',
  'dia': 'day',
  'mes': 'month',
  'aÃ±o': 'year',
  'nombre': 'name',
  'apellido': 'last name',
  'email': 'email',
  'correo': 'email',
  'telefono': 'phone',
  'direccion': 'address',
  'ciudad': 'city',
  'pais': 'country',
  'codigo': 'code',
  'descripcion': 'description',
  'notas': 'notes',
  'comentarios': 'comments',
  'estado': 'status',
  'tipo': 'type',
  'formato': 'format',
  'archivo': 'file',
  'archivos': 'files',
  'documento': 'document',
  'documentos': 'documents',
  'imagen': 'image',
  'imagenes': 'images',
  'foto': 'photo',
  'fotos': 'photos',
  'fotografia': 'photography',
  'fotografo': 'photographer',
  'fotografos': 'photographers',
  'video': 'video',
  'videos': 'videos',
  'musica': 'music',
  'cancion': 'song',
  'canciones': 'songs',
  'ceremonia': 'ceremony',
  'banquete': 'banquet',
  'recepcion': 'reception',
  'boda': 'wedding',
  'bodas': 'weddings',
  'evento': 'event',
  'eventos': 'events',
  'usuario': 'user',
  'usuarios': 'users',
  'perfil': 'profile',
  'configuracion': 'settings',
  'ajustes': 'settings',
  'opciones': 'options',
  'preferencias': 'preferences',
  'sesion': 'session',
  'cuenta': 'account',
  'contrasena': 'password',
  'clave': 'key',
  'titulo': 'title',
  'mensaje': 'message',
  'mensajes': 'messages',
  'notificacion': 'notification',
  'notificaciones': 'notifications',
  'alerta': 'alert',
  'alertas': 'alerts',
  'error': 'error',
  'errores': 'errors',
  'exito': 'success',
  'advertencia': 'warning',
  'informacion': 'information',
  'ayuda': 'help',
  'soporte': 'support',
  'busqueda': 'search',
  'resultado': 'result',
  'resultados': 'results',
  'pagina': 'page',
  'paginas': 'pages',
  'lista': 'list',
  'tabla': 'table',
  'formulario': 'form',
  'campo': 'field',
  'campos': 'fields',
  'valor': 'value',
  'valores': 'values',
  'seleccionar': 'select',
  'seleccionado': 'selected',
  'disponible': 'available',
  'no disponible': 'unavailable',
  'activo': 'active',
  'inactivo': 'inactive',
  'pendiente': 'pending',
  'completado': 'completed',
  'confirmado': 'confirmed',
  'rechazado': 'declined',
  'pagado': 'paid',
  'esperado': 'expected',
  'recibido': 'received',
  'nuevo': 'new',
  'antigua': 'old',
  'primero': 'first',
  'ultimo': 'last',
  'siguiente': 'next',
  'anterior': 'previous',
  'inicio': 'home',
  'panel': 'dashboard',
  'tareas': 'tasks',
  'tarea': 'task',
  'proyecto': 'project',
  'proyectos': 'projects',
  'equipo': 'team',
  'miembro': 'member',
  'miembros': 'members',
  'permisos': 'permissions',
  'acceso': 'access',
  'publico': 'public',
  'privado': 'private',
  'compartir': 'share',
  'descargar': 'download',
  'cargar': 'load',
  'cargando': 'loading',
  'guardando': 'saving',
  'procesando': 'processing',
  'espera': 'wait',
  'listo': 'ready',
  'vacio': 'empty',
  'sin': 'without',
  'con': 'with',
  'todos': 'all',
  'ninguno': 'none',
  'algunos': 'some',
  'mas': 'more',
  'menos': 'less',
  'mejor': 'better',
  'peor': 'worse',
  'mayor': 'greater',
  'menor': 'smaller',
  'alto': 'high',
  'bajo': 'low',
  'medio': 'medium',
  'minimo': 'minimum',
  'maximo': 'maximum',
  'promedio': 'average',
  'general': 'general',
  'especifico': 'specific',
  'completo': 'complete',
  'parcial': 'partial',
  'detalle': 'detail',
  'detalles': 'details',
  'resumen': 'summary',
  'vista': 'view',
  'modo': 'mode',
  'tema': 'theme',
  'color': 'color',
  'colores': 'colors',
  'tamano': 'size',
  'ancho': 'width',
  'alto': 'height',
  'largo': 'length',
  'corto': 'short',
  'grande': 'large',
  'pequeno': 'small',
  'mediano': 'medium',
  
  // Boda especifico
  'novia': 'bride',
  'novio': 'groom',
  'pareja': 'couple',
  'testigo': 'witness',
  'testigos': 'witnesses',
  'madrina': 'godmother',
  'padrino': 'godfather',
  'dama': 'bridesmaid',
  'damas': 'bridesmaids',
  'catering': 'catering',
  'menu': 'menu',
  'comida': 'food',
  'bebida': 'drink',
  'bebidas': 'drinks',
  'decoracion': 'decoration',
  'flores': 'flowers',
  'florista': 'florist',
  'salon': 'venue',
  'lugar': 'place',
  'ubicacion': 'location',
  'ruta': 'route',
  'mapa': 'map',
  'direccion': 'address',
  'invitacion': 'invitation',
  'invitaciones': 'invitations',
  'save the date': 'save the date',
  'rsvp': 'rsvp',
  'confirmacion': 'confirmation',
  'asistencia': 'attendance',
  'regalo': 'gift',
  'regalos': 'gifts',
  'lista de regalos': 'gift list',
  'alergias': 'allergies',
  'restricciones': 'restrictions',
  'dieta': 'diet',
  'vegetariano': 'vegetarian',
  'vegano': 'vegan',
  'celÃ­aco': 'celiac',
  'celiaco': 'celiac',
  'luna de miel': 'honeymoon',
  'viaje': 'trip',
  'hotel': 'hotel',
  'reserva': 'reservation',
  'reservas': 'reservations',
  'transporte': 'transportation',
  'autobus': 'bus',
  'coche': 'car',
  'vuelo': 'flight',
  'tren': 'train',
  
  // Tecnicos
  'sincronizado': 'synced',
  'sincronizando': 'syncing',
  'conexion': 'connection',
  'conectado': 'connected',
  'desconectado': 'disconnected',
  'offline': 'offline',
  'online': 'online',
  'version': 'version',
  'actualizacion': 'update',
  'instalacion': 'installation',
  'configuracion': 'configuration',
  'parametros': 'parameters',
  'variable': 'variable',
  'variables': 'variables',
  'funcion': 'function',
  'metodo': 'method',
  'propiedad': 'property',
  'atributo': 'attribute',
  'valor': 'value',
  'valido': 'valid',
  'invalido': 'invalid',
  'requerido': 'required',
  'obligatorio': 'required',
  'opcional': 'optional',
  'predeterminado': 'default',
  'personalizado': 'custom',
  
  // Frases comunes
  'por favor': 'please',
  'gracias': 'thank you',
  'hola': 'hello',
  'adios': 'goodbye',
  'bienvenido': 'welcome',
  'si': 'yes',
  'no': 'no',
  'tal vez': 'maybe',
  'quizas': 'maybe',
  'ahora': 'now',
  'despues': 'later',
  'antes': 'before',
  'hoy': 'today',
  'ayer': 'yesterday',
  'manana': 'tomorrow',
  'semana': 'week',
  'proximos': 'upcoming',
  'recientes': 'recent',
  'historico': 'history',
  'historial': 'history',
};

// Diccionario ES -> FR
const TRANSLATIONS_FR = {
  'aÃ±adir': 'ajouter',
  'anadir': 'ajouter',
  'crear': 'crÃ©er',
  'eliminar': 'supprimer',
  'editar': 'modifier',
  'guardar': 'enregistrer',
  'cancelar': 'annuler',
  'buscar': 'rechercher',
  'filtrar': 'filtrer',
  'cerrar': 'fermer',
  'abrir': 'ouvrir',
  'ver': 'voir',
  'mostrar': 'afficher',
  'ocultar': 'masquer',
  'enviar': 'envoyer',
  'recibir': 'recevoir',
  'confirmar': 'confirmer',
  'actualizar': 'mettre Ã  jour',
  'invitado': 'invitÃ©',
  'invitados': 'invitÃ©s',
  'mesa': 'table',
  'mesas': 'tables',
  'proveedor': 'fournisseur',
  'proveedores': 'fournisseurs',
  'transaccion': 'transaction',
  'transacciones': 'transactions',
  'categoria': 'catÃ©gorie',
  'categorias': 'catÃ©gories',
  'presupuesto': 'budget',
  'gasto': 'dÃ©pense',
  'gastos': 'dÃ©penses',
  'ingreso': 'revenu',
  'ingresos': 'revenus',
  'precio': 'prix',
  'total': 'total',
  'balance': 'solde',
  'fecha': 'date',
  'hora': 'heure',
  'dia': 'jour',
  'mes': 'mois',
  'aÃ±o': 'annÃ©e',
  'nombre': 'nom',
  'email': 'email',
  'correo': 'email',
  'telefono': 'tÃ©lÃ©phone',
  'direccion': 'adresse',
  'ciudad': 'ville',
  'pais': 'pays',
  'descripcion': 'description',
  'estado': 'statut',
  'tipo': 'type',
  'archivo': 'fichier',
  'imagen': 'image',
  'foto': 'photo',
  'fotografia': 'photographie',
  'fotografo': 'photographe',
  'video': 'vidÃ©o',
  'musica': 'musique',
  'cancion': 'chanson',
  'ceremonia': 'cÃ©rÃ©monie',
  'banquete': 'banquet',
  'boda': 'mariage',
  'bodas': 'mariages',
  'usuario': 'utilisateur',
  'perfil': 'profil',
  'configuracion': 'paramÃ¨tres',
  'contrasena': 'mot de passe',
  'mensaje': 'message',
  'mensajes': 'messages',
  'notificacion': 'notification',
  'alerta': 'alerte',
  'error': 'erreur',
  'exito': 'succÃ¨s',
  'advertencia': 'avertissement',
  'ayuda': 'aide',
  'busqueda': 'recherche',
  'resultado': 'rÃ©sultat',
  'resultados': 'rÃ©sultats',
  'lista': 'liste',
  'formulario': 'formulaire',
  'campo': 'champ',
  'valor': 'valeur',
  'seleccionar': 'sÃ©lectionner',
  'disponible': 'disponible',
  'activo': 'actif',
  'pendiente': 'en attente',
  'completado': 'terminÃ©',
  'confirmado': 'confirmÃ©',
  'pagado': 'payÃ©',
  'nuevo': 'nouveau',
  'primero': 'premier',
  'ultimo': 'dernier',
  'siguiente': 'suivant',
  'anterior': 'prÃ©cÃ©dent',
  'inicio': 'accueil',
  'panel': 'tableau de bord',
  'tareas': 'tÃ¢ches',
  'tarea': 'tÃ¢che',
  'cargando': 'chargement',
  'guardando': 'enregistrement',
  'todos': 'tous',
  'ninguno': 'aucun',
  'mas': 'plus',
  'menos': 'moins',
  'alto': 'Ã©levÃ©',
  'bajo': 'faible',
  'medio': 'moyen',
  'resumen': 'rÃ©sumÃ©',
  'detalle': 'dÃ©tail',
  'novia': 'mariÃ©e',
  'novio': 'mariÃ©',
  'pareja': 'couple',
  'catering': 'traiteur',
  'menu': 'menu',
  'decoracion': 'dÃ©coration',
  'flores': 'fleurs',
  'salon': 'lieu',
  'invitacion': 'invitation',
  'regalo': 'cadeau',
  'regalos': 'cadeaux',
  'alergias': 'allergies',
  'transporte': 'transport',
  'sincronizado': 'synchronisÃ©',
  'conexion': 'connexion',
  'offline': 'hors ligne',
  'online': 'en ligne',
  'requerido': 'requis',
  'obligatorio': 'obligatoire',
  'opcional': 'optionnel',
  'si': 'oui',
  'no': 'non',
  'hoy': 'aujourd\'hui',
  'manana': 'demain',
  'semana': 'semaine',
};

function translateText(text, targetLang) {
  if (!text || typeof text !== 'string') return text;
  
  const dict = targetLang === 'en' ? TRANSLATIONS_EN : TRANSLATIONS_FR;
  
  // Traducir palabra por palabra
  const words = text.toLowerCase().split(/\s+/);
  const translated = words.map(word => {
    // Quitar acentos para buscar
    const normalized = word.normalize('NFD').replace(/[\u0300-\u036f]/g, '');
    return dict[normalized] || dict[word] || word;
  });
  
  return translated.join(' ');
}

function translateKeys(namespace, lang) {
  const esPath = path.join(LOCALES_DIR, 'es', `${namespace}.json`);
  const targetPath = path.join(LOCALES_DIR, lang, `${namespace}.json`);
  
  if (!fs.existsSync(esPath)) return;
  
  const esData = JSON.parse(fs.readFileSync(esPath, 'utf-8'));
  const targetData = fs.existsSync(targetPath) 
    ? JSON.parse(fs.readFileSync(targetPath, 'utf-8'))
    : {};
  
  let translated = 0;
  
  Object.keys(esData).forEach(key => {
    const esValue = esData[key];
    
    // Si ya existe traduccion, no sobrescribir
    if (targetData[key] && targetData[key] !== esValue) return;
    
    // Si es igual al espaÃ±ol, traducir
    if (!targetData[key] || targetData[key] === esValue) {
      targetData[key] = translateText(esValue, lang);
      translated++;
    }
  });
  
  // Ordenar claves
  const sorted = Object.keys(targetData).sort().reduce((acc, key) => {
    acc[key] = targetData[key];
    return acc;
  }, {});
  
  fs.writeFileSync(targetPath, JSON.stringify(sorted, null, 2), 'utf-8');
  
  return { total: Object.keys(targetData).length, translated };
}

function main() {
  console.log('ðŸŒ Traduciendo claves i18n...\n');
  
  const namespaces = ['common', 'auth'];
  const languages = ['en', 'fr'];
  
  let totalTranslated = 0;
  
  languages.forEach(lang => {
    console.log(`\nðŸ“ Traduciendo a ${lang.toUpperCase()}:`);
    namespaces.forEach(ns => {
      const result = translateKeys(ns, lang);
      if (result) {
        console.log(`   âœ“ ${ns}.json - ${result.translated} claves traducidas (${result.total} total)`);
        totalTranslated += result.translated;
      }
    });
  });
  
  console.log(`\nâœ… Traduccion completada - ${totalTranslated} claves traducidas\n`);
}

main();
